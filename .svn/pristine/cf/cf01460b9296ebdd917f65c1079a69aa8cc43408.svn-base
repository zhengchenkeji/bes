package com.zc.efounder.JEnterprise.controller.energyAnalysis;

import com.ruoyi.common.core.domain.AjaxResult;
import com.ruoyi.common.utils.poi.ExcelUtil;
import com.zc.efounder.JEnterprise.domain.energyAnalysis.vo.ReportFormResult;
import com.zc.efounder.JEnterprise.service.energyAnalysis.reportFormService;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.ResponseBody;

import javax.servlet.http.HttpServletResponse;
import java.util.Date;
import java.util.List;

/**
 * description:集抄报表控制器
 * author: sunshangeng
 * date:2022/11/28 9:54
 */
@Controller
@RequestMapping("/energyAnalysis/reportForm")
public class ReportFormController {

    @Autowired
    private reportFormService testservice;

    @RequestMapping("/list")
    @ResponseBody
    public AjaxResult list(Long[] branchIds ,Date[] time)
    {
        return  testservice.service(branchIds,time);
    }
    @RequestMapping("/export")
    @ResponseBody
    public void export(Long[] branchIds , Date[] time, HttpServletResponse response)
    {
        List<ReportFormResult> resultList;
        AjaxResult result = testservice.service(branchIds, time);
        resultList= (List<ReportFormResult>)result.get("data");
        ExcelUtil<ReportFormResult> util = new ExcelUtil<>(ReportFormResult.class);
        util.exportExcel(response, resultList, "集抄报表");


    }

}
